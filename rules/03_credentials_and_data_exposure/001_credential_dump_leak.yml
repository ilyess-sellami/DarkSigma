title: Credential Dump or Leak Indicators
id: 0e1f2a3b-4c5d-6e7f-8123-9a0b1c2d3e4f
status: stable
description: Detects traffic or files that contain patterns consistent with credential dumps (email:password combos, long lists, common leaked password tokens, or many cleartext credentials in a single transfer).
author: Ilyess Sellami
date: 2025-09-27
references:
  - https://attack.mitre.org/techniques/T1078/
tags:
  - attack.credential_access
  - attack.collection
logsource:
  category: proxy
  product: any
detection:
  selection_text_patterns:
    Body|re:
      - "(?i)[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,}:[^\\s]{4,100}"   # email:password-ish
      - "(?i)(combo list|combo-list|combo_list|combo\\s+list|credentials dump|credential dump)"
      - "(?i)\\b(passwords?:|pw:|pass:)\\b"
    Url|re:
      - "(?i).*\\b(combolist|combo-list|credentials|dumps|full-dump|db-dump)\\b.*"
  condition: selection_text_patterns
falsepositives:
  - logs containing benign exports (support tools, legitimate password resets); correlate with source, destination and host reputation
level: critical
confidence: high
detection_notes: >
  This rule flags payloads that contain many credential-like entries. For production, pipe matched events into a correlation/search that counts unique credentials per event and flags when threshold (e.g., >10 credentials in a single transfer) is exceeded. Enrich with file hash, source reputation, and destination (.onion / marketplace) context.
