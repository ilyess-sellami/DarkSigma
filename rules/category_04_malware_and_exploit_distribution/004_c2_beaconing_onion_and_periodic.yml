title: C2 Beaconing to .onion or Known C2 Hosts Detected
id: 4c5d6e7f-8a9b-0c1d-2e3f-4a5b6c7d8e9f
status: experimental
description: "Detects repeated outbound connections indicative of C2 beaconing to .onion addresses, tor gateways, or known C2 domains. Correlation/aggregation required to detect periodicity; this rule flags candidate C2 hosts for correlation."
author: Ilyess Sellami
date: 2025-09-27
references:
  - https://attack.mitre.org/techniques/T1071/
tags:
  - attack.command_and_control
logsource:
  category: network_connection
  product: any
detection:
  selection_c2_host:
    DestinationHost|re:
      - "(?i).*\\.onion$"
      - "(?i).*\\b(c2|cmd|control|panel|onion|drop|beacon)\\b.*"
  condition: selection_c2_host
falsepositives:
  - sanctioned research traffic to .onion or telemetry to vendor panels; require allowlist
level: critical
confidence: medium
detection_notes: >
  Sigma cannot express "periodic every X seconds" in a single rule across all backends. Implement a correlation search that counts connections to the same DestinationHost by src_ip over sliding windows (e.g., check for >= 6 connections at ~regular intervals within 10 minutes). Enrich with domain/IP reputation and TOR relay lists.
