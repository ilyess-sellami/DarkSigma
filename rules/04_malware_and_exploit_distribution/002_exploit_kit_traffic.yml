title: Exploit Kit / Drive by Exploit Traffic Detected
id: a3b2c1d0-9f8e-4b7a-8c6d-5e4f3a2b1c0f
status: experimental
description: :Detects web traffic patterns indicative of exploit kits or drive by attacks sequences of redirect/iframe/payload requests, exploit paths, or payload filenames commonly used by EK frameworks."
author: Ilyess Sellami
date: 2025-09-27
references:
  - https://attack.mitre.org/techniques/T1189/
tags:
  - attack.initial_access
  - attack.execution
logsource:
  category: proxy
  product: any
detection:
  selection_ek_paths:
    Url|re:
      - "(?i).*/(exploit|ek|payload|swf|flash|exploit-kit|driveby|iframe|redirect)/.*"
      - "(?i).*\\bexploit\\b.*(\\.js|\\.swf|\\.jar|\\.php).*"
  selection_js_payload:
    Body|re:
      - "(?i)eval\\(|new\\s+ActiveXObject|document\\.createElement\\(|unescape\\(|atob\\(|fromCharCode\\("
  condition: selection_ek_paths or selection_js_payload
falsepositives:
  - ad networks and benign redirect chains; correlate referrer, UA, and upstream chain length
level: critical
confidence: medium
detection_notes: >
  Exploit kits often manifest as short redirect chains with suspicious JS. Correlate multiple small GETs, unexpected content-type changes, or sandbox detonation results. Consider adding JA3/JA3S and user-agent heuristics to reduce noise.
